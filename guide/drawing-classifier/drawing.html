



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Machine Learning models that play by the rules, literally.">
      
      
        <link rel="canonical" href="https://koaning.github.io/human-learn/guide/drawing-classifier/drawing.html">
      
      
        <meta name="author" content="Vincent D. Warmerdam">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../icon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Drawing as a Model - Human-Learn</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../style.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#drawing-as-a-model" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://koaning.github.io/human-learn/" title="Human-Learn" aria-label="Human-Learn" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../icon.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Human-Learn
            </span>
            <span class="md-header-nav__topic">
              
                Drawing as a Model
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/koaning/human-learn/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../index.html" class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../function-classifier/function-classifier.html" class="md-tabs__link md-tabs__link--active">
          Guides
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../api/classification.html" class="md-tabs__link">
          Api
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../examples/examples.html" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://koaning.github.io/human-learn/" title="Human-Learn" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../icon.png" width="48" height="48">
      
    </a>
    Human-Learn
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/koaning/human-learn/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Home
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../index.html" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../function-classifier/function-classifier.html" title="Function as a Model" class="md-nav__link">
      Function as a Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../function-preprocess/function-preprocessing.html" title="Human Preprocessing" class="md-nav__link">
      Human Preprocessing
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Drawing as a Model
      </label>
    
    <a href="drawing.html" title="Drawing as a Model" class="md-nav__link md-nav__link--active">
      Drawing as a Model
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classic-classification-problem" class="md-nav__link">
    Classic Classification Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-draw" class="md-nav__link">
    Let's Draw!
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instructions" class="md-nav__link">
    Instructions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties-of-modelling-technique" class="md-nav__link">
    Properties of Modelling Technique
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-jupyter" class="md-nav__link">
    From Jupyter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialize" class="md-nav__link">
    Serialize
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notebook" class="md-nav__link">
    Notebook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../finding-outliers/outliers.html" title="Outliers and Comfort" class="md-nav__link">
      Outliers and Comfort
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Api
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Api
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/classification.html" title="Classification" class="md-nav__link">
      Classification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/regression.html" title="Regression" class="md-nav__link">
      Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/outlier.html" title="Outlier" class="md-nav__link">
      Outlier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/preprocessing.html" title="Preprocessing" class="md-nav__link">
      Preprocessing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Interactive
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Interactive
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/interactive-charts.html" title="Charts" class="md-nav__link">
      Charts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Utility
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Utility
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/common.html" title="Common" class="md-nav__link">
      Common
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/datasets.html" title="Datasets" class="md-nav__link">
      Datasets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/examples.html" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/faq.html" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#classic-classification-problem" class="md-nav__link">
    Classic Classification Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-draw" class="md-nav__link">
    Let's Draw!
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instructions" class="md-nav__link">
    Instructions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties-of-modelling-technique" class="md-nav__link">
    Properties of Modelling Technique
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-jupyter" class="md-nav__link">
    From Jupyter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serialize" class="md-nav__link">
    Serialize
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notebook" class="md-nav__link">
    Notebook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/koaning/human-learn/edit/master/docs/guide/drawing-classifier/drawing.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="drawing-as-a-model">Drawing as a Model<a class="headerlink" href="#drawing-as-a-model" title="Permanent link">&para;</a></h1>
<h2 id="classic-classification-problem">Classic Classification Problem<a class="headerlink" href="#classic-classification-problem" title="Permanent link">&para;</a></h2>
<p>Let's look at a dataset that describes a classification problem. In particular, we're looking at the
<a href="https://github.com/allisonhorst/palmerpenguins">pallmer penguin dataset</a> here.</p>
<p><img src="chart.png" width=500/></p>
<p>The goal is to predict the colors of the points. Very commonly folks would look at this and say;</p>
<p><img alt="" src="stick-figure.png" /></p>
<p>But maybe, this is a wrong interpretation. Maybe the problem isn't the fact
that as a human we can't split up the points. Instead the problem here is
that code is not the best user-interface. Sure, writing the code to split
the points is hard but if we could just draw, it'd be much easier.</p>
<h2 id="lets-draw">Let's Draw!<a class="headerlink" href="#lets-draw" title="Permanent link">&para;</a></h2>
<p>Because we've got the web at our disposal and tools like <a href="https://docs.bokeh.org/en/latest/index.html">bokeh</a>
we can also turn the static chart into an interactive one. The nice thing
about interactive charts is that we can interact with them. The chart below
allows you to draw on the canvas.</p>
<iframe src="chart.html" style="width:500px; height: 420px; border: 0px;""></iframe>

<h3 id="instructions">Instructions<a class="headerlink" href="#instructions" title="Permanent link">&para;</a></h3>
<p>To draw, you first need to pick a color. Then you can double click in the canvas
to start drawing a polygon. Once you're done drawing you can double click again
to stop shaping the polygon. A drawn polygon can be moved by clicking and dragging.
You can delete a polygon by clicking it once and hitting backspace. You can also edit
it by clicking the edit button (immediately under the green button). You can delete
a polygon by first clicking the polygon once and then hitting backspace.</p>
<p>Once you're done drawing you might end up with a drawing that looks like this.</p>
<p><img src="draw.png" width=500/></p>
<p>When you look at it such a drawing. It makes you wonder, wouldn't it be nice if
this was the output of a machine learning model?</p>
<h2 id="properties-of-modelling-technique">Properties of Modelling Technique<a class="headerlink" href="#properties-of-modelling-technique" title="Permanent link">&para;</a></h2>
<p>Instead of doing machine learning we're doing "human learning" here. We can literally
draw out what we think the computer should predict and there's some interesting benefits
to consider.</p>
<ol>
<li>By drawing on the data, you're immediately forced to understand it. The act of modelling now also includes the act
of exploratory analysis.</li>
<li>By drawing the model, you immediately interpret and understand it better. This is great when you think about
themes like fairness. It's still not 100% perfect but the added interpretability should make it a lot easier to
prevent artificial stupidity.</li>
<li>You can draw on the canvas, even if there's no data! This is something that machine learning algorithms typically
have the worst time ever with. If you're doing fraud modelling, then you can manually specify a region to be "risky"
even when there is no data for it!</li>
<li>You can draw on the canvas, even if there's no labels! You might be able to come up with a "common sense" drawing
even if there are no labels available. The model will be fully heuristic based, but perhaps still useful.</li>
<li>We can interpret the drawing in many ways. Maybe if you've not drawn a region we can interpret it as "wont predict here".
This can be a like-able safety mechanism.</li>
<li>If nothing else, these drawings should serve as a lovely benchmark. If the performance of your deep ensemble model
isn't significantly better than a drawn model, then you may not need the complex model.</li>
</ol>
<h2 id="from-jupyter">From Jupyter<a class="headerlink" href="#from-jupyter" title="Permanent link">&para;</a></h2>
<p>In reality one 2D chart is probably not going to cut it. So in a jupyter notebook you can drawn many! Here's how it works.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sklego.datasets</span> <span class="kn">import</span> <span class="n">load_penguins</span>
<span class="kn">from</span> <span class="nn">hulearn.experimental.interactive</span> <span class="kn">import</span> <span class="n">InteractiveCharts</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">load_penguins</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">InteractiveClassifierCharts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
</code></pre></div>

<p>The <code>clf</code> variable contains a <code>InteractiveClassifierCharts</code> object that has assumed that the <code>"species"</code> column in <code>df</code>
to represent the label that we're interested in. From here you can generate charts, via;</p>
<div class="highlight"><pre><span></span><code><span class="c1"># It&#39;s best to run this in a single cell.</span>
<span class="n">clf</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;bill_length_mm&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;bill_depth_mm&quot;</span><span class="p">)</span>
</code></pre></div>

<p>You can also generate a second chart.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Again, run this in a seperate cell.</span>
<span class="n">clf</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;flipper_length_mm&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;body_mass_g&quot;</span><span class="p">)</span>
</code></pre></div>

<p>This will generate two interactive charts where you can "draw" you model. The final drawn result might look
something like this;</p>
<p><img alt="" src="jupyter.png" /></p>
<h2 id="serialize">Serialize<a class="headerlink" href="#serialize" title="Permanent link">&para;</a></h2>
<p>You can translate these decision boundaries to a machine learning model if you want. To do that you first need to
translate your drawings to json.</p>
<div class="highlight"><pre><span></span><code><span class="n">drawn_data</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="c1"># You can also save the data to disk if you want.</span>
<span class="n">clf</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;drawn-model.json&quot;</span><span class="p">)</span>
</code></pre></div>

<details>
  <summary><b>What the json file looks like.</b></summary>
<div class="highlight"><pre><span></span><code><span class="p">[{</span><span class="s1">&#39;chart_id&#39;</span><span class="o">:</span> <span class="s1">&#39;3c680a70-0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;x&#39;</span><span class="o">:</span> <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span>
  <span class="s1">&#39;y&#39;</span><span class="o">:</span> <span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span>
  <span class="s1">&#39;polygons&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;Adelie&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">32.14132787891895</span><span class="p">,</span>
      <span class="mf">32.84074984423687</span><span class="p">,</span>
      <span class="mf">38.78583654943918</span><span class="p">,</span>
      <span class="mf">46.829189150595255</span><span class="p">,</span>
      <span class="mf">47.17890013325422</span><span class="p">,</span>
      <span class="mf">43.68179030666462</span><span class="p">,</span>
      <span class="mf">35.63843770550855</span><span class="p">]],</span>
    <span class="s1">&#39;bill_depth_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">15.406862190509665</span><span class="p">,</span>
      <span class="mf">19.177207018095874</span><span class="p">,</span>
      <span class="mf">21.487207018095873</span><span class="p">,</span>
      <span class="mf">21.5934139146476</span><span class="p">,</span>
      <span class="mf">19.217943123601575</span><span class="p">,</span>
      <span class="mf">16.640631196069247</span><span class="p">,</span>
      <span class="mf">15.244587235322568</span><span class="p">]]},</span>
   <span class="s1">&#39;Gentoo&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">58.10736834134671</span><span class="p">,</span>
      <span class="mf">50.501154468514336</span><span class="p">,</span>
      <span class="mf">40.18468048007502</span><span class="p">,</span>
      <span class="mf">40.09725273441028</span><span class="p">,</span>
      <span class="mf">44.556067763312015</span><span class="p">,</span>
      <span class="mf">53.12398683845653</span><span class="p">,</span>
      <span class="mf">58.894218052329364</span><span class="p">,</span>
      <span class="mf">60.76142402357685</span><span class="p">]],</span>
    <span class="s1">&#39;bill_depth_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">17.284959177952327</span><span class="p">,</span>
      <span class="mf">17.553429170403614</span><span class="p">,</span>
      <span class="mf">14.627106252684614</span><span class="p">,</span>
      <span class="mf">13.201081726611287</span><span class="p">,</span>
      <span class="mf">12.051605398390103</span><span class="p">,</span>
      <span class="mf">13.827533449580619</span><span class="p">,</span>
      <span class="mf">15.667347786949287</span><span class="p">,</span>
      <span class="mf">17.024587871893388</span><span class="p">]]},</span>
   <span class="s1">&#39;Chinstrap&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">44.11892903498832</span><span class="p">,</span>
      <span class="mf">40.88410244539294</span><span class="p">,</span>
      <span class="mf">45.51777296562416</span><span class="p">,</span>
      <span class="mf">51.72514290782069</span><span class="p">,</span>
      <span class="mf">56.621096665046124</span><span class="p">,</span>
      <span class="mf">58.019940595681966</span><span class="p">,</span>
      <span class="mf">53.29884232978601</span><span class="p">,</span>
      <span class="mf">52.511992618803355</span><span class="p">,</span>
      <span class="mf">47.004044641924736</span><span class="p">]],</span>
    <span class="s1">&#39;bill_depth_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">16.103691211166677</span><span class="p">,</span>
      <span class="mf">16.72117219380463</span><span class="p">,</span>
      <span class="mf">19.217943123601575</span><span class="p">,</span>
      <span class="mf">20.85561007755441</span><span class="p">,</span>
      <span class="mf">21.124080070005693</span><span class="p">,</span>
      <span class="mf">19.540107114543115</span><span class="p">,</span>
      <span class="mf">18.57361514171849</span><span class="p">,</span>
      <span class="mf">16.39900820286309</span><span class="p">,</span>
      <span class="mf">15.915762216450778</span><span class="p">]]}}},</span>
 <span class="p">{</span><span class="s1">&#39;chart_id&#39;</span><span class="o">:</span> <span class="s1">&#39;198b23fb-5&#39;</span><span class="p">,</span>
  <span class="s1">&#39;x&#39;</span><span class="o">:</span> <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">,</span>
  <span class="s1">&#39;y&#39;</span><span class="o">:</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span>
  <span class="s1">&#39;polygons&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;Adelie&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">205.39985750238202</span><span class="p">,</span>
      <span class="mf">205.39985750238202</span><span class="p">,</span>
      <span class="mf">184.0772104628077</span><span class="p">,</span>
      <span class="mf">174.80649435864495</span><span class="p">,</span>
      <span class="mf">170.235872105095</span><span class="p">,</span>
      <span class="mf">161.6171609214579</span><span class="p">,</span>
      <span class="mf">174.42229536301556</span><span class="p">,</span>
      <span class="mf">194.38496200094178</span><span class="p">,</span>
      <span class="mf">197.57898866300997</span><span class="p">,</span>
      <span class="mf">209.5565886457657</span><span class="p">,</span>
      <span class="mf">204.4993797641577</span><span class="p">]],</span>
    <span class="s1">&#39;body_mass_g&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">4079.2264346061725</span><span class="p">,</span>
      <span class="mf">4876.092877056334</span><span class="p">,</span>
      <span class="mf">4876.092877056334</span><span class="p">,</span>
      <span class="mf">4067.842628285456</span><span class="p">,</span>
      <span class="mf">3521.4199248910595</span><span class="p">,</span>
      <span class="mf">3088.8352847038286</span><span class="p">,</span>
      <span class="mf">2781.4725140444807</span><span class="p">,</span>
      <span class="mf">2781.4725140444807</span><span class="p">,</span>
      <span class="mf">3134.370509986695</span><span class="p">,</span>
      <span class="mf">3555.5713438532093</span><span class="p">,</span>
      <span class="mf">3737.7122449846747</span><span class="p">]]},</span>
   <span class="s1">&#39;Gentoo&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">208.77192413146238</span><span class="p">,</span>
      <span class="mf">201.53909280616116</span><span class="p">,</span>
      <span class="mf">216.39571931218526</span><span class="p">,</span>
      <span class="mf">232.7342009323645</span><span class="p">,</span>
      <span class="mf">241.9517683831975</span><span class="p">,</span>
      <span class="mf">222.55068229508308</span><span class="p">]],</span>
    <span class="s1">&#39;body_mass_g&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">3898.03455221242</span><span class="p">,</span>
      <span class="mf">4740.103517729661</span><span class="p">,</span>
      <span class="mf">6171.487627453468</span><span class="p">,</span>
      <span class="mf">6230.793172902075</span><span class="p">,</span>
      <span class="mf">5650.448345315868</span><span class="p">,</span>
      <span class="mf">4603.5517935917305</span><span class="p">]]},</span>
   <span class="s1">&#39;Chinstrap&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">215.1341094117529</span><span class="p">,</span>
      <span class="mf">195.202069787803</span><span class="p">,</span>
      <span class="mf">173.41588694302055</span><span class="p">,</span>
      <span class="mf">181.06422772895482</span><span class="p">,</span>
      <span class="mf">197.75151671644775</span><span class="p">,</span>
      <span class="mf">212.35289458050406</span><span class="p">]],</span>
    <span class="s1">&#39;body_mass_g&#39;</span><span class="o">:</span> <span class="p">[[</span><span class="mf">4330.448345315868</span><span class="p">,</span>
      <span class="mf">4626.310414281385</span><span class="p">,</span>
      <span class="mf">3272.1724832469026</span><span class="p">,</span>
      <span class="mf">2698.5776834613475</span><span class="p">,</span>
      <span class="mf">2872.5429646102134</span><span class="p">,</span>
      <span class="mf">3646.641794418942</span><span class="p">]]}}}]</span>
</code></pre></div>
</details>

<p>This data represents the drawings that you've made.</p>
<h2 id="model">Model<a class="headerlink" href="#model" title="Permanent link">&para;</a></h2>
<p>This generated data can be read in by our <code>InteractiveClassifier</code> which will allow you to use your drawn model
as a scikit-learn model.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hulearn.classification</span> <span class="kn">import</span> <span class="n">InteractiveClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">InteractiveClassifier</span><span class="p">(</span><span class="n">json_desc</span><span class="o">=</span><span class="n">drawn_data</span><span class="p">)</span>
<span class="c1"># Alternatively you can also load from disk.</span>
<span class="n">InteractiveClassifier</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;drawn-model.json&quot;</span><span class="p">)</span>
</code></pre></div>

<p>This model can be used to make predictions but you will still need to follow the standard <code>.fit(X, y)</code> and <code>.predict(X)</code> pattern.</p>
<div class="highlight"><pre><span></span><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

<p>We can confirm that it has picked up the pattern that we drew too! The charts below show the predicted values
<code>preds</code> plotted over the original charts that we drew.</p>
<p><img alt="" src="preds-1.png" />
<img alt="" src="preds-2.png" /></p>
<details>
  <summary><b>Code for the plots.</b></summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">preds</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">preds</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div>
</details>

<p>Because we've been drawing on two charts you should notice that the predictions won't match our drawings 100%. Internally
we check if a point falls into a drawn polygon and a single point typically fits into more than a single polygon. If a point
does not fit into any polygon then we assign a flat probability value to it.</p>
<p>The details of how points in polygons are weighted will be explored with hyperparemters that will be added to the API.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>The goal of this library is to make it easier to apply common sense to construct models. By thinking more in terms of
"human learning" as opposed to "machine learning" you might be able to make models that are guaranteed to follow the rules.</p>
<h3 id="notebook">Notebook<a class="headerlink" href="#notebook" title="Permanent link">&para;</a></h3>
<p>If you want to run this code yourself, feel free to download the <a href="../notebooks/03-interactive.ipynb">notebook</a>.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../function-preprocess/function-preprocessing.html" title="Human Preprocessing" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Human Preprocessing
              </span>
            </div>
          </a>
        
        
          <a href="../finding-outliers/outliers.html" title="Outliers and Comfort" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Outliers and Comfort
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Maintained by <a href="https://twitter.com/fishnets88">Vincent</a>.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>